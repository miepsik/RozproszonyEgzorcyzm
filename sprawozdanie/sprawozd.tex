%@descr: wzór sprawozdania, raportu lub pracy - nadaje się do przeróbek
%@author: Maciej Komosiński

\documentclass{article} 
\usepackage{polski} %moze wymagac dokonfigurowania latexa, ale jest lepszy niż standardowy babel'owy [polish] 
\usepackage[utf8]{inputenc} 
\usepackage[OT4]{fontenc} 
\usepackage{graphicx,color} %include pdf's (and png's for raster graphics... avoid raster graphics!) 
\usepackage{url} 
\usepackage[pdftex,hyperfootnotes=false,pdfborder={0 0 0}]{hyperref} %za wszystkimi pakietami; pdfborder nie wszedzie tak samo zaimplementowane bo specyfikacja nieprecyzyjna; pod miktex'em po prostu nie widac wtedy ramek


\input{_ustawienia.tex}

%\title{Sprawozdanie z laboratorium:\\Metaheurystyki i Obliczenia Inspirowane Biologicznie}
%\author{}
%\date{}


\begin{document}

\input{_tytulowa}

\section{Wstęp}
Zakładamy niezawodne kanały FIFO, jednostkowy czas przesyłania wiadomości oraz zerowy czas przetwarzania lokalnego.
\begin{tightlist}
    \item $n$ - liczba procesów
    \item $pid$ - identyfikator konkretnego procesu z zakresu [0 - n-1]
    \item $D$ - liczba domów do straszenia
    \item $M$ - liczba urządeń do wytwarzania sztucznej mgły
    \item $P$ - liczba prześcieradeł
    \item $K$ - liczba magnetofonów
    \item $z[n]$ - tablica zawierająca liczebność i-tej grupy
\end{tightlist}

\section{Algorytm}
Proces będzie kolejno przechodził przez sekcje krytyczne najpierw związane ze zdobyciem magnetofonu oraz urządzenia do mgły, następna sekcja krytyczna dotyczy zdobycia odpowiedniej liczby prześcieradeł i na koniec wybranie domu do straszenia.
\subsection{Magnetofon oraz mgła}
Rozbijanie tego na dwie osobne sekcje nie ma sensu, gdyż i tak wąskim gardłem będzie ten zasób, którego jest mniej, czyli w tym wypadku urządzeń do wytwarzania mgły. Każdy proces ubiega się o jeden nierozróżnialny magnetofon i jedno nierozróżnialne urządzenie do wytwarzania mgły.
\begin{enumerate}
    \item Proces ubiegający się o wejście do sekcji krytycznej wysyła informację o tym do wszystkich pozostałych procesów. 
    \item Jeśli proces nie ubiega się o sekcję krytyczną, lub na jego zegarze jest większa wartość wysyła ACK. Jeśli natomiast także ubiega się o sekcję krytyczną i jednocześnie jest starszy wtedy zapamiętuje sobie proces, który ubiegał się o zgodę i wysyła mu ACK po opuszczeniu sekcji krytycznej.
    \item Proces ubiegający się o wejście do sekcji krytycznej wchodzi do niej po zebraniu $n - M$ zgód
    \item Po opuszczeniu sekcji krytycznej wysyła ACK do młodszych procesów, które także ubiegały się o wejście
\end{enumerate}
\subsection{Prześcieradła}
Każdy proces stara się o uzyskanie $z[pid]$ z $P$ nierozróżnialnych prześcieradeł.
\begin{enumerate}
    \item Proces ubiegający się o prześcieradła wysyła informację zawierającą ilość potrzebnych prześcieradeł do wszystkich pozostałych procesów
    \item Jeśli proces nie ubiega się o prześcieradła, lub jest młodszy odsyła informację, iż rezerwuje on $0$ prześcieradeł. W przeciwnym wypadku $pid$-y proces odsyła informację o rezerwacji $z[pid]$ prześcieradeł i zapamiętuje proces ubiegający się o prześcieradła. Po oddaniu prześcieradeł wysyła on informację o zwróceniu zasobów.
    \item Proces ubiegający się o prześcieradła czeka na wiadomości od wszystkich procesów a następnie aktualizuje informacje aż liczba wolnych prześcieradeł będzie większa bądź równa $z[pid]$.
    \item Po opuszczeniu sekcji krytycznej wysyła informację o zwolnieniu prześcieradeł do wszystkich procesów, którym wcześniej wysłał informację o zarezerwowaniu prześcieradeł.
\end{enumerate}
\subsection{Domy}
Każdy proces stara się zarezerwować sobie dom do straszenia, przy czym jeden dom nie może być rezerwowany zbyt często. Wprowadzamy dodatkową zmienną tablicową boolowską $H[D]$ informującą o tym, czy w danym domu można straszyć.
\begin{enumerate}
    \item Proces zaczyna rezerwację domów od domu o numerze $ i = pid * \frac{D}{n}$.
    \item Jeśli $H[i] == false$ to proces stara się o rezerwację domu o numerze $(++i) \% D$.
    \item Proces wysyła do wszystkich pozostałych procesów informację o domu w którym chce straszyć.
    \item Jeśli proces otrzymujący wiadomość nie chce straszyć w tym domu, lub jest młodszy wysyła zgodę. W przeciwnym wypadku wysyła zabronienie.
    \item Jeśli proces otrzyma od wszystkich zgodę może straszyć w domu, ustawia $H[i] = false$, oraz $H[j] = true$, gdzie $j$ to identyfikator domu w którym straszył sotatnio. Jeśli otrzyma chociaż jedno zabronienie stara się o rezerwację domu o numerze $(++i) \% D$
\end{enumerate}

*W przypadku gdy dostaliśmy zgodę na wejście do sekcji krytycznej od starszego procesu, który następnie sam chce wejść do tej sekcji wysyłamy mu naszą zgodę, cofamy sobie jego zgodę i prosimy o nią ponownie (dostaniemy ją po tym jak starszy proces opuści sekcję krytyczną).

%%%%%%%%%%%%%%%% literatura %%%%%%%%%%%%%%%%

\bibliography{sprawozd}
\bibliographystyle{plain}


\end{document}

